"use strict";(self.webpackChunkboba_watch=self.webpackChunkboba_watch||[]).push([[458],{9268:function(n,e,t){t.d(e,{SJ:function(){return m},ul:function(){return p},df:function(){return _}});var o=t(8182),r=t(2791),a=t(1768),i=t(500),c=t(5026),s=t(2333),u="UserLocationButton_button__mgCvr",l="UserLocationButton_center__59pZY",d=t(184),f=function(n){var e=n.setPosition,t=(0,c.Z)(),f=(0,a.Sx)(),p=(0,r.useCallback)((function(){if(!(null!==t&&void 0!==t&&t.lat||null!==t&&void 0!==t&&t.lng))return null;e([t.lat,t.lng]),f.flyTo([t.lat,t.lng],13,{animate:!0,duration:1})}),[t,f,e]);return(0,r.useEffect)(p,[p]),(0,d.jsxs)(d.Fragment,{children:[(null===t||void 0===t?void 0:t.lat)&&(null===t||void 0===t?void 0:t.lng)&&(0,d.jsx)(i.c,{center:[t.lat,t.lng],radius:5,fill:!0,color:"#B64040",fillColor:"#B64040",fillOpacity:"1"}),(0,d.jsx)("button",{className:(0,o.Z)(u,l),onClick:p,children:(0,d.jsx)(s.Z,{})})]})},p=(0,r.memo)(f),m=function(n){var e=n.center,t=(0,a.Sx)();return(0,r.useEffect)((function(){t.flyTo(e,13,{animate:!0,duration:.5})}),[e,t]),(0,d.jsx)("div",{})},h=t(2840),v=t(5987),x=t(885),g=["location","id","address","date"],j=function(n){var e=(0,r.useState)([]),t=(0,x.Z)(e,2),o=t[0],a=t[1];return(0,r.useEffect)((function(){a(Object.values(n.reduce((function(n,e){var t=e.location,o=e.id,r=e.address,a=e.date;(0,v.Z)(e,g);if(null===r||void 0===r||!r.lat||null===r||void 0===r||!r.lng)return n;var i=Number(r.lat).toFixed(6),c=Number(r.lng).toFixed(6),s="".concat(i,",").concat(c).concat(t);return n.hasOwnProperty(s)?n[s].drinks.push({id:o,date:a}):n[s]={coordinates:[i,c],location:t,address:r,drinks:[{id:o,date:a}]},n}),{})))}),[n]),{locations:o}},b=t(1951),Z="VisitedLocations_container__kuIJ6",_=function(n){var e=n.drinks,t=j(e).locations;return(0,d.jsx)(d.Fragment,{children:t.map((function(n){var e=n.coordinates,t=n.drinks,o=n.location;return(0,d.jsx)(i.c,{center:e,radius:10,fill:!0,weight:1,color:"#F68080",fillColor:"#F68080",fillOpacity:"0.5",children:(0,d.jsx)(h.G,{children:(0,d.jsxs)("div",{className:Z,children:[(0,d.jsx)("h2",{children:o}),(0,d.jsxs)("p",{children:["Visited ",(0,d.jsx)("span",{children:t.length})," times"]}),(0,d.jsx)("p",{children:"Recent visits:"}),t.slice(0,5).map((function(n){var e=n.date;return(0,d.jsx)("div",{children:(0,b.Z)(new Date(e),"MMM d, yyyy h:mm a")},e)}))]})})},JSON.stringify(e)+o)}))})}},2495:function(n,e,t){t.d(e,{Fy:function(){return o.Z},M7:function(){return r.Z},tx:function(){return a.Z}});t(5691);var o=t(9312),r=t(1748),a=t(3568);t(5026),t(2791),t(6831),t(7426),t(8228)},1748:function(n,e,t){var o=t(885),r=t(2791);e.Z=function(){var n=(0,r.useState)([]),e=(0,o.Z)(n,2),t=e[0],a=e[1],i=(0,r.useState)([]),c=(0,o.Z)(i,2),s=c[0],u=c[1],l=(0,r.useCallback)((function(){a(JSON.parse(localStorage.getItem("drinkids")))}),[]);return(0,r.useEffect)(l,[l]),(0,r.useEffect)((function(){u(t.map((function(n){return JSON.parse(localStorage.getItem(n))})))}),[t]),{drinkids:t,drinks:s,update:l}}},3568:function(n,e,t){var o=t(2791);e.Z=function(){var n=(0,o.useCallback)((function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o="https://us-central1-boba-watch-firebase.cloudfunctions.net/locator";fetch(o+"?"+new URLSearchParams(n).toString()).then((function(n){return n.json()})).then(e).catch(t)}),[]),e=(0,o.useCallback)((function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o="https://us-central1-boba-watch-firebase.cloudfunctions.net/nearbyLocations";fetch(o+"?"+new URLSearchParams(n).toString()).then((function(n){return n.json()})).then(e).catch(t)}),[]);return{getLocationsNearby:n,getLocationsByText:e}}},5026:function(n,e,t){var o=t(1413),r=t(885),a=t(2791);e.Z=function(){var n=(0,a.useState)({}),e=(0,r.Z)(n,2),t=e[0],i=e[1],c=(0,a.useState)(null),s=(0,r.Z)(c,2),u=s[0],l=s[1],d=function(n){l(n.message)},f=function(n){var e=n.coords,t=n.timestamp;i({accuracy:e.accuracy,alt:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,lat:e.latitude,lng:e.longitude,timestamp:t})};return(0,a.useEffect)((function(){navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(f,d,{}):l("Geolocation is not supported")}),[]),(0,o.Z)((0,o.Z)({},t),{},{error:u})}},7426:function(n,e,t){var o=t(885),r=t(2791),a=t(5135),i=t(242),c=t(4674),s=t(4796);e.Z=function(n){var e=(0,r.useState)((0,s.Qe)()),t=(0,o.Z)(e,2),u=t[0],l=t[1],d=(0,r.useContext)(c.Z),f=(0,o.Z)(d,1)[0];return(0,r.useEffect)((function(){if(void 0===n||f.uid===n)return l(JSON.parse(localStorage.getItem("metrics")));l({}),a.Fs.collection("users/".concat(n,"/user")).doc("stats").get().then((function(n){l(n.data())})).catch(i.qQ)}),[n,f.uid]),u}},3458:function(n,e,t){t.r(e),t.d(e,{default:function(){return k}});var o=t(885),r=t(2791),a=t(6433),i=t(9268),c=t(2495),s=t(7579),u=t(1830),l=t.n(u),d=t(8182),f=t(842),p=t(1463),m=t(6633),h="MapActions_container__KSxYw",v="MapActions_expand__jaSpq",x="MapActions_open__lSpOj",g=t(184),j=function(n){var e=n.localOnly,t=n.setLocalOnly,a=(0,r.useState)(!1),i=(0,o.Z)(a,2),c=i[0],s=i[1];return(0,g.jsxs)("div",{className:h,children:[c&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("button",{onClick:function(){return t((function(n){return!n}))},children:e?(0,g.jsx)(f.Z,{}):(0,g.jsx)(p.Z,{})})}),(0,g.jsx)("button",{onClick:function(){return s((function(n){return!n}))},className:(0,d.Z)(v,c&&x),children:(0,g.jsx)(m.Z,{})})]})},b=(0,r.memo)(j),Z=t(3168),_="MobileLocator_container__QNRD8",y="MobileLocator_map__VLQoq",S="MobileLocator_search-area--btn__xozZb",C=function(n){var e=n.theme,t=(0,Z.$)().t,u=(0,r.useState)(null),d=(0,o.Z)(u,2),f=d[0],p=d[1],m=(0,r.useState)(null),h=(0,o.Z)(m,2),v=(h[0],h[1]),x=(0,r.useState)(!0),j=(0,o.Z)(x,2),C=j[0],k=j[1],L=(0,r.useState)(null),N=(0,o.Z)(L,2),w=N[0],E=N[1],M=(0,c.M7)().drinks,O=(0,r.useState)({openNow:!1,coffee:!1}),F=(0,o.Z)(O,2),z=F[0];F[1];return(0,r.useEffect)((function(){l().mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(n){n.addEventListener("mouseenter",l().stopTimer),n.addEventListener("mouseleave",l().resumeTimer)}}).fire({icon:"success",text:t(C?"Showing visited places":"Finding nearby places")})}),[C,t]),(0,g.jsx)("div",{className:_,children:(0,g.jsx)(a.D5,{className:y,zoom:11,center:w,setCenter:E,theme:e,zoomControl:!1,children:function(n){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b,{localOnly:C,setLocalOnly:k}),C?(0,g.jsx)(i.df,{drinks:M}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(s.rD,{className:S,setStores:p,position:w,filters:z}),f&&f.map((function(n){return(0,g.jsx)(s.bb,{data:n,setSelected:v,setCenter:E},n.venue.id)}))]})]})}})})},k=(0,r.memo)(C)},7579:function(n,e,t){t.d(e,{hR:function(){return p},NB:function(){return v},aT:function(){return h},rD:function(){return _},bb:function(){return N}});var o=t(2791),r=t(3168),a=t(6433),i="Listing_container__lr9Zl",c="Listing_center__wH56q",s="Listing_distance__Sifwb",u="Listing_address__5MjCZ",l=t(184),d=function(n){var e,t=n.data,d=n.selected,f=n.setCenter,p=(0,r.$)().t,m=t.venue.id,h=(0,o.useRef)(null);return(0,o.useEffect)((function(){d===m&&h.current.scrollIntoView({behavior:"smooth"})}),[d,m]),(0,l.jsxs)(a.Zb,{className:i,forwardedref:h,children:[(0,l.jsx)("h3",{children:t.venue.name}),(0,l.jsxs)("p",{className:s,children:[(0,l.jsx)("span",{children:(e=t.venue.location.distance,e>1e3?(e/1e3).toFixed(2)+" "+p("km"):e+" "+p("meters"))})," ",p("from search pin")]}),(0,l.jsx)("p",{className:u,children:t.venue.location.formattedAddress.join(", ")}),(0,l.jsx)("span",{className:c,onClick:function(){f([t.venue.location.lat,t.venue.location.lng])},children:p("center on map")})]})},f=(0,o.memo)(d),p=function(){return(0,l.jsxs)(a.Zb,{className:i,children:[(0,l.jsx)("h3",{children:"no places nearby :("}),(0,l.jsx)("p",{className:s,children:"We can't seem to find any boba places near you. Try searching a different part of the map."})]})},m=function(){return(0,l.jsxs)(a.Zb,{className:i,children:[(0,l.jsx)("h3",{children:"Loading...."}),(0,l.jsxs)("p",{className:s,children:["Trying to find places near you. If this is taking too long, check your internet and try again.",(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),"Make sure you have your location enabled otherwise you will need to manually search"]})]})},h=(0,o.memo)(m),v=f,x=t(1768),g=t(8182),j=t(2495),b="SearchAreaButton_button__PpKcD",Z=function(n){var e=n.className,t=n.position,a=n.setStores,i=n.filters,c=(0,r.$)().t,s=(0,x.Sx)(),u=(0,j.tx)().getLocationsNearby,d=(0,o.useCallback)((function(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"map";if("user"===e)n={lat:t[0],lng:t[1]};else n=s.getCenter();var o={lat:n.lat,lng:n.lng,open:i.openNow?"true":"false",coffee:i.coffee?"true":"false"};a(null),u(o,(function(n){a(n.response.groups[0].items)}),(function(n){console.error("ERROR:",n),a([])}))}),[s,t,a,i,u]);return(0,o.useEffect)((function(){t&&d("user")}),[t,d]),(0,l.jsx)("button",{className:(0,g.Z)(b,e),onClick:d,children:c("search this area")})},_=(0,o.memo)(Z),y=t(500),S=t(2840),C=t(3504),k="StoreMarker_popup__ylxB1",L=function(n){var e=n.data,t=n.setCenter,o=n.setSelected,a=(0,r.$)().t,i=e.venue.location;return(0,l.jsx)(y.c,{center:[i.lat,i.lng],radius:10,fill:!0,weight:1,color:"#F68080",fillColor:"#F68080",fillOpacity:"0.5",eventHandlers:{click:function(){t([i.lat,i.lng]),o(e.venue.id)}},children:(0,l.jsx)(S.G,{children:(0,l.jsxs)("div",{className:k,children:[(0,l.jsx)("h3",{children:e.venue.name}),(0,l.jsx)("span",{children:e.venue.location.address}),(0,l.jsx)(C.rU,{to:"/add",state:{address:e.venue.location,location:e.venue.name},children:a("add drink for this location")})]})})})},N=(0,o.memo)(L)},6633:function(n,e,t){var o=t(5318),r=t(862);e.Z=void 0;var a=r(t(2791)),i=(0,o(t(4894)).default)(a.createElement("path",{d:"M15.88 9.29L12 13.17 8.12 9.29a.9959.9959 0 00-1.41 0c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0z"}),"ExpandMoreRounded");e.Z=i},842:function(n,e,t){var o=t(5318),r=t(862);e.Z=void 0;var a=r(t(2791)),i=(0,o(t(4894)).default)(a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5.5-2.5l7.51-3.49L17.5 6.5 9.99 9.99 6.5 17.5zm5.5-6.6c.61 0 1.1.49 1.1 1.1s-.49 1.1-1.1 1.1-1.1-.49-1.1-1.1.49-1.1 1.1-1.1z"}),"ExploreOutlined");e.Z=i},1463:function(n,e,t){var o=t(5318),r=t(862);e.Z=void 0;var a=r(t(2791)),i=(0,o(t(4894)).default)(a.createElement("path",{d:"M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm2.19 12.19L6 18l3.81-8.19L18 6l-3.81 8.19z"}),"ExploreRounded");e.Z=i},2333:function(n,e,t){var o=t(5318),r=t(862);e.Z=void 0;var a=r(t(2791)),i=(0,o(t(4894)).default)(a.createElement("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V2c0-.55-.45-1-1-1s-1 .45-1 1v1.06C6.83 3.52 3.52 6.83 3.06 11H2c-.55 0-1 .45-1 1s.45 1 1 1h1.06c.46 4.17 3.77 7.48 7.94 7.94V22c0 .55.45 1 1 1s1-.45 1-1v-1.06c4.17-.46 7.48-3.77 7.94-7.94H22c.55 0 1-.45 1-1s-.45-1-1-1h-1.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"MyLocationRounded");e.Z=i},2840:function(n,e,t){t.d(e,{G:function(){return i}});var o=t(203),r=t(8559),a=t(2791),i=(0,o.SO)((function(n,e){return{instance:new r.Popup(n,e.overlayContainer),context:e}}),(function(n,e,t,o){var r=t.onClose,i=t.onOpen,c=t.position;(0,a.useEffect)((function(){var t=n.instance;function a(n){n.popup===t&&(t.update(),o(!0),null==i||i())}function s(n){n.popup===t&&(o(!1),null==r||r())}return e.map.on({popupopen:a,popupclose:s}),null==e.overlayContainer?(null!=c&&t.setLatLng(c),t.openOn(e.map)):e.overlayContainer.bindPopup(t),function(){e.map.off({popupopen:a,popupclose:s}),e.map.removeLayer(t)}}),[n,e,o,r,i,c])}))},1768:function(n,e,t){t.d(e,{Sx:function(){return r}});var o=t(4666);t(2791);function r(){return(0,o.mE)().map}}}]);
//# sourceMappingURL=458.8bb3f799.chunk.js.map